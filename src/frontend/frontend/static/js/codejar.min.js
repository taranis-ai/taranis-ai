/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/codejar@4.2.0/dist/codejar.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const t=window;function e(e,n,o={}){const r={tab:"\t",indentOn:/[({\[]$/,moveToNewLine:/^[)}\]]/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:t,...o},i=r.window,s=i.document,d=[],a=[];let c,l=-1,f=!1,u=()=>{};e.setAttribute("contenteditable","plaintext-only"),e.setAttribute("spellcheck",r.spellcheck?"true":"false"),e.style.outline="none",e.style.overflowWrap="break-word",e.style.overflowY="auto",e.style.whiteSpace="pre-wrap";const p=(t,e)=>{n(t,e)};let h=!1;"plaintext-only"!==e.contentEditable&&(h=!0),h&&e.setAttribute("contenteditable","true");const g=_((()=>{const t=E();p(e,t),m(t)}),30);let y=!1;const N=t=>!D(t)&&!S(t)&&"Meta"!==t.key&&"Control"!==t.key&&"Alt"!==t.key&&!t.key.startsWith("Arrow"),T=_((t=>{N(t)&&(w(),y=!1)}),300),C=(t,n)=>{d.push([t,n]),e.addEventListener(t,n)};function E(){const t=P(),n={start:0,end:0,dir:void 0};let{anchorNode:o,anchorOffset:r,focusNode:i,focusOffset:d}=t;if(!o||!i)throw"error1";if(o===e&&i===e)return n.start=r>0&&e.textContent?e.textContent.length:0,n.end=d>0&&e.textContent?e.textContent.length:0,n.dir=d>=r?"->":"<-",n;if(o.nodeType===Node.ELEMENT_NODE){const t=s.createTextNode("");o.insertBefore(t,o.childNodes[r]),o=t,r=0}if(i.nodeType===Node.ELEMENT_NODE){const t=s.createTextNode("");i.insertBefore(t,i.childNodes[d]),i=t,d=0}return O(e,(t=>{if(t===o&&t===i)return n.start+=r,n.end+=d,n.dir=r<=d?"->":"<-","stop";if(t===o){if(n.start+=r,n.dir)return"stop";n.dir="->"}else if(t===i){if(n.end+=d,n.dir)return"stop";n.dir="<-"}t.nodeType===Node.TEXT_NODE&&("->"!=n.dir&&(n.start+=t.nodeValue.length),"<-"!=n.dir&&(n.end+=t.nodeValue.length))})),e.normalize(),n}function m(t){const n=P();let o,r,i=0,d=0;if(t.dir||(t.dir="->"),t.start<0&&(t.start=0),t.end<0&&(t.end=0),"<-"==t.dir){const{start:e,end:n}=t;t.start=n,t.end=e}let a=0;O(e,(e=>{if(e.nodeType!==Node.TEXT_NODE)return;const n=(e.nodeValue||"").length;if(a+n>t.start&&(o||(o=e,i=t.start-a),a+n>t.end))return r=e,d=t.end-a,"stop";a+=n})),o||(o=e,i=e.childNodes.length),r||(r=e,d=e.childNodes.length),"<-"==t.dir&&([o,i,r,d]=[r,d,o,i]);{const t=b(o);if(t){const e=s.createTextNode("");t.parentNode?.insertBefore(e,t),o=e,i=0}const e=b(r);if(e){const t=s.createTextNode("");e.parentNode?.insertBefore(t,e),r=t,d=0}}n.setBaseAndExtent(o,i,r,d),e.normalize()}function b(t){for(;t&&t!==e;){if(t.nodeType===Node.ELEMENT_NODE){const e=t;if("false"==e.getAttribute("contenteditable"))return e}t=t.parentNode}}function x(){const t=P().getRangeAt(0),n=s.createRange();return n.selectNodeContents(e),n.setEnd(t.startContainer,t.startOffset),n.toString()}function k(){const t=P().getRangeAt(0),n=s.createRange();return n.selectNodeContents(e),n.setStart(t.endContainer,t.endOffset),n.toString()}function v(t){if(h&&"Enter"===t.key)if(K(t),t.stopPropagation(),""==k()){A("\n ");const t=E();t.start=--t.end,m(t)}else A("\n")}function w(){if(!f)return;const t=e.innerHTML,n=E(),o=a[l];if(o&&o.html===t&&o.pos.start===n.start&&o.pos.end===n.end)return;l++,a[l]={html:t,pos:n},a.splice(l+1);l>300&&(l=300,a.splice(0,1))}function O(t,e){const n=[];t.firstChild&&n.push(t.firstChild);let o=n.pop();for(;o&&"stop"!==e(o);)o.nextSibling&&n.push(o.nextSibling),o.firstChild&&n.push(o.firstChild),o=n.pop()}function M(t){return t.metaKey||t.ctrlKey}function D(t){return M(t)&&!t.shiftKey&&"Z"===L(t)}function S(t){return M(t)&&t.shiftKey&&"Z"===L(t)}function L(t){let e=t.key||t.keyCode||t.which;if(e)return("string"==typeof e?e:String.fromCharCode(e)).toUpperCase()}function A(t){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),s.execCommand("insertHTML",!1,t)}function _(t,e){let n=0;return(...o)=>{clearTimeout(n),n=i.setTimeout((()=>t(...o)),e)}}function B(t){let e=t.length-1;for(;e>=0&&"\n"!==t[e];)e--;e++;let n=e;for(;n<t.length&&/[ \t]/.test(t[n]);)n++;return[t.substring(e,n)||"",e,n]}function H(){return e.textContent||""}function K(t){t.preventDefault()}function P(){return e.parentNode?.nodeType==Node.DOCUMENT_FRAGMENT_NODE?e.parentNode.getSelection():i.getSelection()}return C("keydown",(t=>{t.defaultPrevented||(c=H(),r.preserveIdent?function(t){if("Enter"===t.key){const e=x(),n=k();let[o]=B(e),i=o;if(r.indentOn.test(e)&&(i+=r.tab),i.length>0?(K(t),t.stopPropagation(),A("\n"+i)):v(t),i!==o&&r.moveToNewLine.test(n)){const t=E();A("\n"+o),m(t)}}}(t):v(t),r.catchTab&&function(t){if("Tab"===t.key)if(K(t),t.shiftKey){const t=x();let[e,n]=B(t);if(e.length>0){const t=E(),o=Math.min(r.tab.length,e.length);m({start:n,end:n+o}),s.execCommand("delete"),t.start-=o,t.end-=o,m(t)}}else A(r.tab)}(t),r.addClosing&&function(t){const e="([{'\"",n=")]}'\"";if(e.includes(t.key)){K(t);const o=E(),r=o.start==o.end?"":P().toString();A(t.key+r+n[e.indexOf(t.key)]),o.start++,o.end++,m(o)}}(t),r.history&&(!function(t){if(D(t)){K(t),l--;const n=a[l];n&&(e.innerHTML=n.html,m(n.pos)),l<0&&(l=0)}if(S(t)){K(t),l++;const n=a[l];n&&(e.innerHTML=n.html,m(n.pos)),l>=a.length&&l--}}(t),N(t)&&!y&&(w(),y=!0)),h&&!function(t){return M(t)&&"C"===L(t)}(t)&&m(E()))})),C("keyup",(t=>{t.defaultPrevented||t.isComposing||(c!==H()&&g(),T(t),u(H()))})),C("focus",(t=>{f=!0})),C("blur",(t=>{f=!1})),C("paste",(t=>{w(),function(t){if(t.defaultPrevented)return;K(t);const n=t.originalEvent??t,o=n.clipboardData.getData("text/plain").replace(/\r\n?/g,"\n"),r=E();A(o),p(e),m({start:Math.min(r.start,r.end)+o.length,end:Math.min(r.start,r.end)+o.length,dir:"<-"})}(t),w(),u(H())})),C("cut",(t=>{w(),function(t){const n=E(),o=P(),r=t.originalEvent??t;r.clipboardData.setData("text/plain",o.toString()),s.execCommand("delete"),p(e),m({start:Math.min(n.start,n.end),end:Math.min(n.start,n.end),dir:"<-"}),K(t)}(t),w(),u(H())})),{updateOptions(t){Object.assign(r,t)},updateCode(t){e.textContent=t,p(e),u(t)},onUpdate(t){u=t},toString:H,save:E,restore:m,recordHistory:w,destroy(){for(let[t,n]of d)e.removeEventListener(t,n)}}}export{e as CodeJar};export default null;
//# sourceMappingURL=/sm/2875453afaa763275eaf05ec7008993e27499834a7aaefd5cf72871eec6fcb34.map